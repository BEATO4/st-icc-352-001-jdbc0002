<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <title>Blog PUCMM</title>
</head>
<body>
<nav class="navbar navbar-light bg-light">
  <div class="container">
    <span class="navbar-brand">Blog ICC-352</span>
    <div class="d-flex align-items-center">

      <span th:if="${usuario != null}" class="d-inline-flex align-items-center me-3">
        <img th:if="${usuario.fotoPerfilBase64 != null}"
             th:src="${usuario.fotoPerfilBase64}"
             alt="Perfil" class="rounded-circle me-2" style="width: 35px; height: 35px; object-fit: cover;">
        <span th:text="'Hola, ' + ${usuario.nombre}"></span>
      </span>

      <a th:if="${usuario == null}" href="/login" class="btn btn-primary">Login</a>
      <a th:if="${usuario != null}" href="/crear-articulo" class="btn btn-success me-2">Crear Artículo</a>
      <a th:if="${usuario != null}" href="/logout" class="btn btn-danger">Salir</a>
    </div>
  </div>
</nav>

<div class="container mt-4">
  <div class="row">
    <div class="col-md-8">

      <div th:each="art : ${articulos}" class="card mb-4">
        <div class="card-body">
          <h2 class="card-title" th:text="${art.titulo}">Titulo</h2>
          <p class="card-text" th:text="${art.resumen}">Resumen...</p>
          <a th:href="@{/articulo/{id}(id=${art.id})}" class="btn btn-primary">Leer más &rarr;</a>
        </div>
        <div class="card-footer text-muted">
          Posteado el <span th:text="${art.fecha}"></span> por <span th:text="${art.autor.username}"></span>
          <a th:each="tag : ${art.listaEtiquetas}"
             th:href="@{/(etiqueta=${tag.etiqueta})}"
             th:text="${tag.etiqueta}"
             class="badge bg-primary text-decoration-none me-1"></a>
        </div>
      </div>

      <div th:if="${etiquetaFiltro == null}" class="d-flex justify-content-between mt-4 mb-4">
        <a th:if="${paginaActual > 1}" th:href="@{/(pagina=${paginaActual - 1})}" class="btn btn-outline-primary">Anterior</a>
        <span th:unless="${paginaActual > 1}" class="btn btn-outline-secondary disabled">Anterior</span>

        <span class="align-self-center" th:text="'Página ' + ${paginaActual} + ' de ' + ${totalPaginas}"></span>

        <a th:if="${paginaActual < totalPaginas}" th:href="@{/(pagina=${paginaActual + 1})}" class="btn btn-outline-primary">Siguiente</a>
        <span th:unless="${paginaActual < totalPaginas}" class="btn btn-outline-secondary disabled">Siguiente</span>
      </div>

      <div th:if="${etiquetaFiltro != null}" class="mt-4 mb-4 text-center">
        <h5 th:text="'Filtrando por etiqueta: ' + ${etiquetaFiltro}"></h5>
        <a href="/" class="btn btn-primary">Ver todos los artículos</a>
      </div>

    </div>
    <div class="col-md-4">
      <div class="card my-4">
        <h5 class="card-header">Etiquetas</h5>
        <div class="card-body">
          <p class="text-muted">Selecciona una etiqueta en cualquier post para filtrar.</p>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</body>
</html>